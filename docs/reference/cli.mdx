---
title: "CLI Reference"
description: "Command-line interface for Kapso"
---

## Overview

Kapso provides a CLI for running experiments without writing Python code.

## Basic Usage

```bash
PYTHONPATH=. python -m src.cli --goal "Your problem description"
```

## Options

### Goal Specification

| Option | Short | Description |
|--------|-------|-------------|
| `--goal` | `-g` | Goal/problem description (inline) |
| `--goal-file` | `-f` | File containing goal description |

```bash
# Inline goal
python -m src.cli --goal "Build a classifier for Iris dataset"

# From file
python -m src.cli --goal-file problem.txt
```

### Basic Options

| Option | Short | Default | Description |
|--------|-------|---------|-------------|
| `--iterations` | `-i` | `1` | Maximum experiment iterations |
| `--output` | `-o` | auto | Output directory for solution |

```bash
python -m src.cli --goal "..." --iterations 10 --output ./my_solution
```

### Configuration Options

| Option | Short | Description |
|--------|-------|-------------|
| `--mode` | `-m` | Configuration mode (GENERIC, MINIMAL, TREE_SEARCH) |
| `--coding-agent` | `-a` | Coding agent (aider, gemini, claude_code, openhands) |

```bash
python -m src.cli --goal "..." --mode TREE_SEARCH --coding-agent gemini
```

### Execution Options

| Option | Default | Description |
|--------|---------|-------------|
| `--main-file` | `main.py` | Entry point file |
| `--language` | `python` | Programming language |
| `--timeout` | `300` | Execution timeout in seconds |

```bash
python -m src.cli --goal "..." --main-file app.py --timeout 600
```

### Evaluation Options

| Option | Default | Description |
|--------|---------|-------------|
| `--evaluator` | `no_score` | Evaluator type |
| `--stop-condition` | `never` | Stop condition type |

```bash
python -m src.cli --goal "..." \
    --evaluator regex_pattern \
    --stop-condition threshold
```

### List Commands

| Option | Description |
|--------|-------------|
| `--list-agents` | List available coding agents |
| `--list-evaluators` | List available evaluators |
| `--list-stop-conditions` | List available stop conditions |

```bash
python -m src.cli --list-agents
python -m src.cli --list-evaluators
python -m src.cli --list-stop-conditions
```

## Examples

### Simple Usage

```bash
PYTHONPATH=. python -m src.cli \
    --goal "Build a random forest classifier for the Iris dataset"
```

### With Evaluation

```bash
PYTHONPATH=. python -m src.cli \
    --goal "Build a classifier with accuracy > 0.9" \
    --evaluator regex_pattern \
    --stop-condition threshold
```

### Full Options

```bash
PYTHONPATH=. python -m src.cli \
    --goal-file problem.txt \
    --iterations 20 \
    --mode TREE_SEARCH \
    --coding-agent gemini \
    --main-file main.py \
    --language python \
    --timeout 600 \
    --evaluator llm_judge \
    --stop-condition plateau \
    --output ./my_solution
```

## Output

```
============================================================
EVOLVING: Build a random forest classifier for the Iris dataset
============================================================
  Max iterations: 10
  Language: python
  Main file: main.py
  Evaluator: regex_pattern
  Stop condition: threshold
  Coding agent: from config

Running experiments...
Experiment 1 completed with cumulative cost: $0.125
####################################################################################################
Experiment with final score 0.92:
# Solution: Random forest with GridSearchCV hyperparameter tuning...
####################################################################################################

============================================================
Evolution Complete
============================================================
Solution at: ./my_solution
Experiments run: 3
Total cost: $0.450

============================================================
COMPLETED
============================================================
Solution: ./my_solution
Cost: $0.450
```

## Environment Variables

The CLI loads environment variables from `.env`:

```bash
OPENAI_API_KEY=your-openai-api-key
GOOGLE_API_KEY=your-google-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key
```

## Available Coding Agents

```bash
$ python -m src.cli --list-agents

Available Coding Agents:
==================================================
  aider: Git-centric pair programming with diff-based editing
  gemini: Google Gemini SDK for code generation
  claude_code: Anthropic Claude Code CLI for complex refactoring
  openhands: OpenHands agent with sandboxed execution
```

## Available Evaluators

```bash
$ python -m src.cli --list-evaluators

Available Evaluators:
==================================================
  no_score: No scoring, always returns 0
  regex_pattern: Extract score using regex pattern
  file_json: Read score from JSON file
  multi_metric: Weighted combination of multiple metrics
  llm_judge: LLM-based evaluation (flexible criteria)
  llm_comparison: Compare against expected output
  composite: Combine multiple evaluators
```

## Available Stop Conditions

```bash
$ python -m src.cli --list-stop-conditions

Available Stop Conditions:
==================================================
  never: Never stop early
  threshold: Stop when score reaches threshold
  max_iterations: Stop after N iterations
  plateau: Stop if no improvement for N iterations
  cost_limit: Stop when cost limit reached
  time_limit: Stop when time limit reached
  consecutive_errors: Stop after N consecutive errors
  composite: Combine multiple conditions
```

## Exit Codes

| Code | Meaning |
|------|---------|
| `0` | Success |
| `1` | Error (missing arguments, failed experiment) |

## Tips

<Tip>
**Use `--list-*` options** to discover available components.
</Tip>

<Note>
**Set PYTHONPATH** to the project root for imports to work correctly.
</Note>

<Warning>
**API keys are required**. Set them in `.env` or as environment variables.
</Warning>
