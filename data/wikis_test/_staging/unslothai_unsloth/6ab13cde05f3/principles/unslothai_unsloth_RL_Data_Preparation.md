{| class="wikitable" style="float:right; margin-left:1em; width:300px;"
|-
! Knowledge Sources
|
* [[source::Repo|Unsloth|https://github.com/unslothai/unsloth]]
* [[source::Doc|RL Guide|https://docs.unsloth.ai/get-started/reinforcement-learning-rl-guide]]
|-
! Domains
| [[domain::Reinforcement_Learning]], [[domain::Data_Preparation]], [[domain::Prompts]]
|-
! Last Updated
| [[last_updated::2025-12-16 18:00 GMT]]
|}

== Overview ==

Process of preparing prompt datasets for reinforcement learning, where only prompts are provided and responses are generated during training.

=== Description ===

RL data differs from SFT:
- Only prompts required (no ground truth responses)
- Responses generated by model during training
- Reward function evaluates generated responses
- Diverse prompts improve exploration

== Practical Guide ==

=== Prompt-Only Dataset ===
<syntaxhighlight lang="python">
from datasets import load_dataset

# Load prompts (no responses needed)
dataset = load_dataset("json", data_files="prompts.json", split="train")

# Format prompts with chat template
def format_prompt(examples):
    prompts = []
    for query in examples["query"]:
        messages = [
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": query}
        ]
        prompt = tokenizer.apply_chat_template(
            messages,
            tokenize=False,
            add_generation_prompt=True  # Add assistant prefix
        )
        prompts.append(prompt)
    return {"prompt": prompts}

dataset = dataset.map(format_prompt, batched=True)
</syntaxhighlight>

=== Example Data Format ===
<syntaxhighlight lang="json">
[
    {"query": "Solve the equation: 2x + 5 = 13"},
    {"query": "Write a Python function to sort a list"},
    {"query": "Explain quantum entanglement"}
]
</syntaxhighlight>

=== Diverse Prompt Selection ===
<syntaxhighlight lang="python">
# Good RL prompts:
# - Diverse topics and difficulty levels
# - Clear success criteria (for reward)
# - Representative of target distribution

# Avoid:
# - Repetitive prompts
# - Ambiguous tasks
# - Tasks with no clear correct answer
</syntaxhighlight>

== Related Pages ==

=== Implemented By ===
* [[implemented_by::Implementation:unslothai_unsloth_PatchFastRL]]

=== Used In Workflows ===
* [[used_by::Workflow:unslothai_unsloth_GRPO_Reinforcement_Learning]]
