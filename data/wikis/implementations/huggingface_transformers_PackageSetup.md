{| class="wikitable" style="float:right; margin-left:1em; width:300px;"
|-
! Knowledge Sources
|
* [[source::Repo|huggingface_transformers|https://github.com/huggingface/transformers]]
|-
! Domains
| [[domain::Package_Management]]
|-
! Last Updated
| [[last_updated::2025-12-18 12:00 GMT]]
|}

== Overview ==
Setup.py configures the Hugging Face Transformers package for installation via pip with extensive dependency management, extras configuration, and custom build commands.

=== Description ===
This is the primary package configuration file for the Transformers library. It defines the package metadata, core dependencies, optional extras (like torch, vision, audio, deepspeed), and custom setuptools commands. The file implements a sophisticated dependency management system where all dependencies are declared in a single source of truth (_deps list) and then organized into feature-specific extras bundles. It includes a custom DepsTableUpdateCommand that auto-generates a dependency versions table file.

The setup configuration supports multiple installation profiles: minimal (core only), domain-specific (torch, vision, audio), integration-specific (deepspeed, ray, optuna), and comprehensive (dev, all). It also handles backwards compatibility by cleaning up stale egg-info directories and provides detailed release workflow documentation in the header comments.

=== Usage ===
This file is used by pip and setuptools during package installation (pip install transformers) and development setup (pip install -e .). Developers modify this file when adding new dependencies or creating new optional feature sets. The make deps_table_update command uses the custom command class to synchronize dependency versions across the codebase.

== Code Reference ==

=== Source Location ===
* '''Repository:''' [https://github.com/huggingface/transformers huggingface_transformers]
* '''File:''' setup.py

=== Signature ===
<syntaxhighlight lang="python">
# Main setup call
setup(
    name="transformers",
    version="5.0.0.dev0",
    author="The Hugging Face team...",
    install_requires=list(install_requires),
    extras_require=extras,
    python_requires=">=3.10.0",
    packages=find_packages("src"),
    package_dir={"": "src"},
    entry_points={"console_scripts": ["transformers=transformers.cli.transformers:main"]},
    cmdclass={"deps_table_update": DepsTableUpdateCommand}
)

# Dependency management functions
def deps_list(*pkgs):
    return [deps[pkg] for pkg in pkgs]

class DepsTableUpdateCommand(Command):
    def run(self):
        # Updates src/transformers/dependency_versions_table.py
</syntaxhighlight>

=== Import ===
<syntaxhighlight lang="python">
# This file is not imported directly; it's used by pip/setuptools
# Installation usage:
# pip install transformers
# pip install transformers[torch,vision]
# pip install -e .[dev]
</syntaxhighlight>

== I/O Contract ==

=== Core Dependencies (install_requires) ===
{| class="wikitable"
|-
! Dependency !! Version Constraint !! Purpose
|-
| filelock || Latest || Filesystem locks for parallel downloads
|-
| huggingface-hub || >=1.2.1,<2.0 || Model hub integration
|-
| numpy || >=1.17 || Numerical operations
|-
| packaging || >=20.0 || Version comparisons
|-
| pyyaml || Latest || Model card metadata
|-
| regex || !=2019.12.17 || Pattern matching for tokenizers
|-
| requests || Latest || Model downloads over HTTPS
|-
| tokenizers || >=0.22.0,<=0.23.0 || Fast tokenization
|-
| safetensors || >=0.4.3 || Safe tensor serialization
|-
| tqdm || >=4.27 || Progress bars
|}

=== Key Extras Bundles ===
{| class="wikitable"
|-
! Extra !! Key Dependencies !! Use Case
|-
| torch || torch>=2.2, accelerate>=1.1.0 || PyTorch model support
|-
| vision || Pillow>=10.0.1, torchvision || Image processing
|-
| audio || librosa, torchaudio, pyctcdecode, phonemizer || Speech/audio tasks
|-
| sentencepiece || sentencepiece>=0.1.91, protobuf || SentencePiece tokenization
|-
| deepspeed || deepspeed>=0.9.3, accelerate || Large model training
|-
| dev || All features + testing + quality tools || Development environment
|-
| testing || pytest suite + datasets + evaluation tools || Testing suite
|}

=== Output Files ===
{| class="wikitable"
|-
! File !! Generated By !! Purpose
|-
| src/transformers/dependency_versions_table.py || DepsTableUpdateCommand || Dependency version lookup table
|-
| transformers.egg-info/* || setup.py install || Package metadata
|-
| dist/*.whl, dist/*.tar.gz || setup.py sdist bdist_wheel || Distribution packages
|}

== Usage Examples ==
<syntaxhighlight lang="python">
# Basic installation (core dependencies only)
# $ pip install transformers

# Install with PyTorch support
# $ pip install transformers[torch]

# Install with multiple extras
# $ pip install transformers[torch,vision,audio]

# Developer installation with all features
# $ pip install -e .[dev]

# Update dependency versions table
# $ python setup.py deps_table_update

# Build distribution packages
# $ python setup.py sdist bdist_wheel

# Access dependency information programmatically
from transformers.dependency_versions_table import deps
print(deps['torch'])  # 'torch>=2.2'
print(deps['numpy'])  # 'numpy>=1.17'
</syntaxhighlight>

== Related Pages ==
* (Leave empty)
